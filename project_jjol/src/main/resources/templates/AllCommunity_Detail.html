<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/main_layout}">

<head>
	<meta charset="utf-8">
	<title>커뮤니티 상세보기</title>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="card mt-4">
					<div class="card-header">
						<form name="checkForm" id="checkForm" method="post">
							<h3 th:text="${allcommunity.allcTitle}">제목 없음</h3>
							<input type="hidden" name="allcNo" th:value="${allcommunity.allcNo}">
						</form>
					</div>
					<div class="card-body">
						<p class="card-text" th:text="${allcommunity.allcContent}">내용 없음</p>
						<hr>
						<ul class="list-unstyled">
							<li>작성자: <span th:text="${allcommunity.allcName}">작성자 없음</span></li>
							<li>작성일: <span th:text="${#dates.format(allcommunity.allcDate, 'yyyy-MM-dd')}">날짜 없음</span>
							</li>
							<li>파일 다운로드:
								<a th:href="@{/downloadFile/{fileId}(fileId=${allcommunity.allcFile})}"
									th:text="${allcommunity.allcFile}">없음</a>
							</li>
						</ul>
					</div>
					<div class="card-footer">
						<a href="#" onclick="javascript:history.back();">뒤로 가기</a>
						<input class="btn" type="button" id="allcommunityDelete" value="삭제">
						<input class="btn" type="button" id="allcommunityUpdateForm" value="수정하기 폼으로 이동">
					</div>
				</div>
			</div>

			<!--댓글작성-->
			<div class="row mt-4">
				<div class="col-lg-12">
					<div class="card">
						<div class="card-header">
							<h5>댓글</h5>
						</div>
						<div class="card-body">
							<form th:action="@{/addComment}" method="post">
								<input type="hidden" name="allcNo" th:value="${allcommunity.allcNo}">
								<div class="form-group">
									<label for="commentContent">댓글 내용</label>
									<textarea class="form-control" id="commentContent" name="commentContent" rows="3"
										required></textarea>
								</div>
								<button type="submit" class="btn btn-primary">댓글 등록</button>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- 스크립트 -->
		<script>
			$(function () {
				$("#allcommunityDelete").on("click", function () {
					$("#checkForm").attr("action", "/deleteAllCommunity");
					$("#checkForm").attr("method", "post");
					$("#checkForm").submit();
				});

				$("#allcommunityUpdateForm").on("click", function () {
				    var allcNo = $("input[name='allcNo']").val(); // 데이터 번호 가져오기
				    // 수정하기 폼으로 이동
				    window.location.href = '/updateAllCommunityForm?no=' + allcNo; // 수정 폼의 URL
				});

			});
		</script>
	</div>
</body>

</html>